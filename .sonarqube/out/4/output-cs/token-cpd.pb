¯F
zC:\Users\Pim\Desktop\Semester 6\Individual project\Code\vybes-backend\ProfileMicroservice\Controllers\ProfileController.cs
	namespace 	
ProfileMicroservice
 
. 
Controllers )
;) *
[ 
ApiController 
] 
[ 
Route 
( 
$str 
) 
] 
public		 
class		 
ProfileController		 
:		  

Controller		! +
{

 
private 
readonly 
IProfileService $
_profileService% 4
;4 5
public 

ProfileController 
( 
IProfileService ,
profileService- ;
); <
{ 
_profileService 
= 
profileService (
;( )
} 
[ 
HttpGet 
] 
public 

IActionResult 
Index 
( 
)  
{ 
List 
< 
Profile 
> 
profiles 
=  
_profileService! 0
.0 1
GetProfiles1 <
(< =
)= >
;> ?
if 

( 
profiles 
. 
Any 
( 
) 
) 
{ 	
return 
Ok 
( 
profiles 
) 
;  
} 	
return 
NotFound 
( 
$str 0
)0 1
;1 2
} 
[ 
HttpGet 
] 
[   
Route   

(  
 
$str   
)   
]   
public!! 

IActionResult!! 
GetProfileById!! '
(!!' (
long!!( ,
	profileId!!- 6
)!!6 7
{"" 
Profile## 
?## 
profile## 
=## 
_profileService## *
.##* +
GetProfileById##+ 9
(##9 :
	profileId##: C
)##C D
;##D E
if%% 

(%% 
profile%% 
!=%% 
null%% 
)%% 
{&& 	
return'' 
Ok'' 
('' 
profile'' 
)'' 
;'' 
}(( 	
return** 
NotFound** 
(** 
$str** C
+**D E
	profileId**F O
)**O P
;**P Q
}++ 
[-- 
HttpGet-- 
]-- 
[.. 
Route.. 

(..
 
$str.. 
).. 
].. 
public// 

IActionResult// 
GetProfileByUserId// +
(//+ ,
string//, 2
userId//3 9
)//9 :
{00 
Profile11 
?11 
profile11 
=11 
_profileService11 *
.11* +
GetProfileByUserId11+ =
(11= >
userId11> D
)11D E
;11E F
if33 

(33 
profile33 
!=33 
null33 
)33 
{44 	
return55 
Ok55 
(55 
profile55 
)55 
;55 
}66 	
return88 
NotFound88 
(88 
$str88 @
+88A B
userId88C I
)88I J
;88J K
}99 
[;; 
HttpGet;; 
];; 
[<< 
Route<< 

(<<
 
$str<< 
)<< 
]<< 
public== 

IActionResult==  
GetProfileByUserName== -
(==- .
string==. 4
userName==5 =
)=== >
{>> 
Profile?? 
??? 
profile?? 
=?? 
_profileService?? *
.??* +
GetProfileByUserId??+ =
(??= >
userName??> F
)??F G
;??G H
ifAA 

(AA 
profileAA 
!=AA 
nullAA 
)AA 
{BB 	
returnCC 
OkCC 
(CC 
profileCC 
)CC 
;CC 
}DD 	
returnFF 
NotFoundFF 
(FF 
$strFF A
+FFB C
userNameFFD L
)FFL M
;FFM N
}GG 
[II 
HttpPostII 
]II 
[JJ 
RouteJJ 

(JJ
 
$strJJ 
)JJ 
]JJ 
publicKK 

IActionResultKK 

AddProfileKK #
(KK# $
ProfileKK$ +
profileKK, 3
)KK3 4
{LL 
ProfileMM 
?MM 
resultMM 
=MM 
_profileServiceMM )
.MM) *

AddProfileMM* 4
(MM4 5
profileMM5 <
)MM< =
;MM= >
ifOO 

(OO 
resultOO 
!=OO 
nullOO 
)OO 
{PP 	
returnQQ 
OkQQ 
(QQ 
resultQQ 
)QQ 
;QQ 
}RR 	
returnTT 

BadRequestTT 
(TT 
$strTT =
)TT= >
;TT> ?
}UU 
[WW 
HttpPutWW 
]WW 
[XX 
RouteXX 

(XX
 
$strXX 
)XX 
]XX 
publicYY 

IActionResultYY 
UpdateProfileYY &
(YY& '
ProfileYY' .
profileYY/ 6
)YY6 7
{ZZ 
Profile[[ 
?[[ 
result[[ 
=[[ 
_profileService[[ )
.[[) *
UpdateProfile[[* 7
([[7 8
profile[[8 ?
)[[? @
;[[@ A
if]] 

(]] 
result]] 
!=]] 
null]] 
)]] 
{^^ 	
return__ 
Ok__ 
(__ 
result__ 
)__ 
;__ 
}`` 	
returnbb 

BadRequestbb 
(bb 
$strbb =
)bb= >
;bb> ?
}cc 
[ee 

HttpDeleteee 
]ee 
[ff 
Routeff 

(ff
 
$strff 
)ff 
]ff 
publicgg 

IActionResultgg 
DeleteProfilegg &
(gg& '
Profilegg' .
profilegg/ 6
)gg6 7
{hh 
boolii 
resultii 
=ii 
_profileServiceii %
.ii% &
DeleteProfileii& 3
(ii3 4
profileii4 ;
)ii; <
;ii< =
ifkk 

(kk 
resultkk 
)kk 
{ll 	
returnmm 
Okmm 
(mm 
resultmm 
)mm 
;mm 
}nn 	
returnpp 

BadRequestpp 
(pp 
$strpp =
)pp= >
;pp> ?
}qq 
[ss 
HttpGetss 
]ss 
[tt 
Routett 

(tt
 
$strtt "
)tt" #
]tt# $
publicuu 

IActionResultuu "
FindProfilesByUserNameuu /
(uu/ 0
stringuu0 6
userNameuu7 ?
)uu? @
{vv 
Listww 
<ww 
Profileww 
>ww 
profilesww 
=ww  
_profileServiceww! 0
.ww0 1"
FindProfilesByUserNameww1 G
(wwG H
userNamewwH P
)wwP Q
;wwQ R
ifyy 

(yy 
profilesyy 
.yy 
Anyyy 
(yy 
)yy 
)yy 
{zz 	
return{{ 
Ok{{ 
({{ 
profiles{{ 
){{ 
;{{  
}|| 	
return~~ 
NotFound~~ 
(~~ 
$str~~ C
+~~D E
userName~~F N
)~~N O
;~~O P
} 
[
ÅÅ 
HttpGet
ÅÅ 
]
ÅÅ 
[
ÇÇ 
Route
ÇÇ 

(
ÇÇ
 
$str
ÇÇ %
)
ÇÇ% &
]
ÇÇ& '
public
ÉÉ 

IActionResult
ÉÉ '
FindProfilesByDisplayName
ÉÉ 2
(
ÉÉ2 3
string
ÉÉ3 9
displayName
ÉÉ: E
)
ÉÉE F
{
ÑÑ 
List
ÖÖ 
<
ÖÖ 
Profile
ÖÖ 
>
ÖÖ 
?
ÖÖ 
profiles
ÖÖ 
=
ÖÖ  !
_profileService
ÖÖ" 1
.
ÖÖ1 2'
FindProfilesByDisplayName
ÖÖ2 K
(
ÖÖK L
displayName
ÖÖL W
)
ÖÖW X
;
ÖÖX Y
if
áá 

(
áá 
profiles
áá 
.
áá 
Any
áá 
(
áá 
)
áá 
)
áá 
{
àà 	
return
ââ 
Ok
ââ 
(
ââ 
profiles
ââ 
)
ââ 
;
ââ  
}
ää 	
return
åå 
NotFound
åå 
(
åå 
$str
åå G
+
ååH I
displayName
ååJ U
)
ååU V
;
ååV W
}
çç 
}éé ”
nC:\Users\Pim\Desktop\Semester 6\Individual project\Code\vybes-backend\ProfileMicroservice\Data\AppDbContext.cs
	namespace 	
ProfileMicroservice
 
. 
Data "
;" #
public 
class 
AppDbContext 
: 
	DbContext %
{ 
public 

DbSet 
< 
Profile 
> 
Profiles "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
null3 7
!7 8
;8 9
public

 

AppDbContext

 
(

 
DbContextOptions

 (
options

) 0
)

0 1
:

2 3
base

4 8
(

8 9
options

9 @
)

@ A
{ 
} 
} í
åC:\Users\Pim\Desktop\Semester 6\Individual project\Code\vybes-backend\ProfileMicroservice\Data\Repositories\Interfaces\IProfileRepository.cs
	namespace 	
ProfileMicroservice
 
. 
Data "
." #
Repositories# /
./ 0

Interfaces0 :
;: ;
public 
	interface 
IProfileRepository #
{ 
bool 
SaveChanges	 
( 
) 
; 
List		 
<		 	
Profile			 
>		 
GetProfiles		 
(		 
)		 
;		  
Profile 
? 
GetProfileById 
( 
long  
	profileId! *
)* +
;+ ,
Profile 
? 
GetProfileByUserId 
(  
string  &
userId' -
)- .
;. /
Profile 
?  
GetProfileByUserName !
(! "
string" (
userName) 1
)1 2
;2 3
Profile 

AddProfile 
( 
Profile 
profile &
)& '
;' (
Profile 
UpdateProfile 
( 
Profile !
profile" )
)) *
;* +
bool 
DeleteProfile	 
( 
Profile 
profile &
)& '
;' (
bool $
ProfileExistsByProfileId	 !
(! "
long" &
	profileId' 0
)0 1
;1 2
bool !
ProfileExistsByUserId	 
( 
string %
userId& ,
), -
;- .
bool #
ProfileExistsByUserName	  
(  !
string! '
userName( 0
)0 1
;1 2
List 
< 	
Profile	 
> "
FindProfilesByUserName (
(( )
string) /
userName0 8
)8 9
;9 :
List 
< 	
Profile	 
> %
FindProfilesByDisplayName +
(+ ,
string, 2
displayName3 >
)> ?
;? @
}   û<
ÄC:\Users\Pim\Desktop\Semester 6\Individual project\Code\vybes-backend\ProfileMicroservice\Data\Repositories\ProfileRepository.cs
	namespace 	
ProfileMicroservice
 
. 
Data "
." #
Repositories# /
;/ 0
public 
class 
ProfileRepository 
:  
IProfileRepository! 3
{ 
private		 
readonly		 
AppDbContext		 !

_dbContext		" ,
;		, -
public 

ProfileRepository 
( 
AppDbContext )
	dbContext* 3
)3 4
{ 

_dbContext 
= 
	dbContext 
; 
} 
public 

bool 
SaveChanges 
( 
) 
{ 
return 
( 

_dbContext 
. 
SaveChanges &
(& '
)' (
>=) +
$num, -
)- .
;. /
} 
public 

List 
< 
Profile 
> 
GetProfiles $
($ %
)% &
{ 
return 

_dbContext 
. 
Profiles "
. 
AsNoTracking 
( 
) 
. 
ToList 
( 
) 
; 
} 
public 

Profile 
? 
GetProfileById "
(" #
long# '
	profileId( 1
)1 2
{ 
return 

_dbContext 
. 
Profiles "
. 
AsNoTracking 
( 
) 
.   
Where   
(   
x   
=>   
x   
.   
	ProfileId   #
==  $ &
	profileId  ' 0
)  0 1
.!! 
FirstOrDefault!! 
(!! 
)!! 
;!! 
}"" 
public$$ 

Profile$$ 
?$$ 
GetProfileByUserId$$ &
($$& '
string$$' -
userId$$. 4
)$$4 5
{%% 
return&& 

_dbContext&& 
.&& 
Profiles&& "
.'' 
AsNoTracking'' 
('' 
)'' 
.(( 
Where(( 
((( 
x(( 
=>(( 
x(( 
.(( 
UserId((  
==((! #
userId(($ *
)((* +
.)) 
FirstOrDefault)) 
()) 
))) 
;)) 
}** 
public,, 

Profile,, 
?,,  
GetProfileByUserName,, (
(,,( )
string,,) /
userName,,0 8
),,8 9
{-- 
return.. 

_dbContext.. 
... 
Profiles.. "
.// 
AsNoTracking// 
(// 
)// 
.00 
Where00 
(00 
x00 
=>00 
x00 
.00 
UserName00 "
==00# %
userName00& .
)00. /
.11 
FirstOrDefault11 
(11 
)11 
;11 
}22 
public44 

Profile44 

AddProfile44 
(44 
Profile44 %
profile44& -
)44- .
{55 

_dbContext66 
.66 
Profiles66 
.66 
Add66 
(66  
profile66  '
)66' (
;66( )
SaveChanges77 
(77 
)77 
;77 
return99 
profile99 
;99 
}:: 
public<< 

Profile<< 
UpdateProfile<<  
(<<  !
Profile<<! (
profile<<) 0
)<<0 1
{== 

_dbContext>> 
.>> 
Profiles>> 
.>> 
Update>> "
(>>" #
profile>># *
)>>* +
;>>+ ,
SaveChanges?? 
(?? 
)?? 
;?? 
returnAA 
profileAA 
;AA 
}BB 
publicDD 

boolDD 
DeleteProfileDD 
(DD 
ProfileDD %
profileDD& -
)DD- .
{EE 

_dbContextFF 
.FF 
ProfilesFF 
.FF 
RemoveFF "
(FF" #
profileFF# *
)FF* +
;FF+ ,
SaveChangesGG 
(GG 
)GG 
;GG 
returnII 
trueII 
;II 
}JJ 
publicLL 

boolLL $
ProfileExistsByProfileIdLL (
(LL( )
longLL) -
	profileIdLL. 7
)LL7 8
{MM 
returnNN 

_dbContextNN 
.NN 
ProfilesNN "
.NN" #
AnyNN# &
(NN& '
xNN' (
=>NN) +
xNN, -
.NN- .
	ProfileIdNN. 7
==NN8 :
	profileIdNN; D
)NND E
;NNE F
}OO 
publicQQ 

boolQQ !
ProfileExistsByUserIdQQ %
(QQ% &
stringQQ& ,
userIdQQ- 3
)QQ3 4
{RR 
returnSS 

_dbContextSS 
.SS 
ProfilesSS "
.SS" #
AnySS# &
(SS& '
xSS' (
=>SS) +
xSS, -
.SS- .
UserIdSS. 4
==SS5 7
userIdSS8 >
)SS> ?
;SS? @
}TT 
publicVV 

boolVV #
ProfileExistsByUserNameVV '
(VV' (
stringVV( .
userNameVV/ 7
)VV7 8
{WW 
returnXX 

_dbContextXX 
.XX 
ProfilesXX "
.XX" #
AnyXX# &
(XX& '
xXX' (
=>XX) +
xXX, -
.XX- .
UserNameXX. 6
==XX7 9
userNameXX: B
)XXB C
;XXC D
}YY 
public[[ 

List[[ 
<[[ 
Profile[[ 
>[[ "
FindProfilesByUserName[[ /
([[/ 0
string[[0 6
userName[[7 ?
)[[? @
{\\ 
return]] 

_dbContext]] 
.]] 
Profiles]] "
.^^ 
AsNoTracking^^ 
(^^ 
)^^ 
.__ 
Where__ 
(__ 
x__ 
=>__ 
x__ 
.__ 
UserName__ "
.__" #
ToLower__# *
(__* +
)__+ ,
.__, -
Contains__- 5
(__5 6
userName__6 >
.__> ?
ToLower__? F
(__F G
)__G H
)__H I
)__I J
.`` 
ToList`` 
(`` 
)`` 
;`` 
}aa 
publiccc 

Listcc 
<cc 
Profilecc 
>cc %
FindProfilesByDisplayNamecc 2
(cc2 3
stringcc3 9
displayNamecc: E
)ccE F
{dd 
returnee 

_dbContextee 
.ee 
Profilesee "
.ff 
AsNoTrackingff 
(ff 
)ff 
.gg 
Wheregg 
(gg 
xgg 
=>gg 
xgg 
.gg 
DisplayNamegg %
.gg% &
ToLowergg& -
(gg- .
)gg. /
.gg/ 0
Containsgg0 8
(gg8 9
displayNamegg9 D
.ggD E
ToLowerggE L
(ggL M
)ggM N
)ggN O
)ggO P
.hh 
ToListhh 
(hh 
)hh 
;hh 
}ii 
}jj È 
åC:\Users\Pim\Desktop\Semester 6\Individual project\Code\vybes-backend\ProfileMicroservice\Migrations\20220415080346_create-profile-entity.cs
	namespace 	
ProfileMicroservice
 
. 

Migrations (
{ 
public 

partial 
class 
createprofileentity ,
:- .
	Migration/ 8
{		 
	protected

 
override

 
void

 
Up

  "
(

" #
MigrationBuilder

# 3
migrationBuilder

4 D
)

D E
{ 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str  
,  !
columns 
: 
table 
=> !
new" %
{ 
	ProfileId 
= 
table  %
.% &
Column& ,
<, -
long- 1
>1 2
(2 3
type3 7
:7 8
$str9 A
,A B
nullableC K
:K L
falseM R
)R S
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
UserId 
= 
table "
." #
Column# )
<) *
string* 0
>0 1
(1 2
type2 6
:6 7
$str8 G
,G H
nullableI Q
:Q R
falseS X
)X Y
,Y Z
DisplayName 
=  !
table" '
.' (
Column( .
<. /
string/ 5
>5 6
(6 7
type7 ;
:; <
$str= L
,L M
nullableN V
:V W
falseX ]
)] ^
,^ _
About 
= 
table !
.! "
Column" (
<( )
string) /
>/ 0
(0 1
type1 5
:5 6
$str7 F
,F G
nullableH P
:P Q
trueR V
)V W
,W X
PhoneNumber 
=  !
table" '
.' (
Column( .
<. /
string/ 5
>5 6
(6 7
type7 ;
:; <
$str= L
,L M
nullableN V
:V W
trueX \
)\ ]
,] ^
Birthday 
= 
table $
.$ %
Column% +
<+ ,
DateTime, 4
>4 5
(5 6
type6 :
:: ;
$str< G
,G H
nullableI Q
:Q R
falseS X
)X Y
,Y Z
	CreatedAt 
= 
table  %
.% &
Column& ,
<, -
DateTime- 5
>5 6
(6 7
type7 ;
:; <
$str= H
,H I
nullableJ R
:R S
falseT Y
)Y Z
,Z [
	UpdatedAt 
= 
table  %
.% &
Column& ,
<, -
DateTime- 5
>5 6
(6 7
type7 ;
:; <
$str= H
,H I
nullableJ R
:R S
falseT Y
)Y Z
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 2
,2 3
x4 5
=>6 8
x9 :
.: ;
	ProfileId; D
)D E
;E F
} 
) 
; 
} 	
	protected   
override   
void   
Down    $
(  $ %
MigrationBuilder  % 5
migrationBuilder  6 F
)  F G
{!! 	
migrationBuilder"" 
."" 
	DropTable"" &
(""& '
name## 
:## 
$str##  
)##  !
;##! "
}$$ 	
}%% 
}&& é
éC:\Users\Pim\Desktop\Semester 6\Individual project\Code\vybes-backend\ProfileMicroservice\Migrations\20220420080544_add-username-to-profile.cs
	namespace 	
ProfileMicroservice
 
. 

Migrations (
{ 
public 

partial 
class  
addusernametoprofile -
:. /
	Migration0 9
{ 
	protected		 
override		 
void		 
Up		  "
(		" #
MigrationBuilder		# 3
migrationBuilder		4 D
)		D E
{

 	
migrationBuilder 
. 
	AddColumn &
<& '
string' -
>- .
(. /
name 
: 
$str  
,  !
table 
: 
$str !
,! "
type 
: 
$str %
,% &
nullable 
: 
false 
,  
defaultValue 
: 
$str  
)  !
;! "
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 

DropColumn '
(' (
name 
: 
$str  
,  !
table 
: 
$str !
)! "
;" #
} 	
} 
} Í
òC:\Users\Pim\Desktop\Semester 6\Individual project\Code\vybes-backend\ProfileMicroservice\Migrations\20220420093527_nullify-unessential-profile-props.cs
	namespace 	
ProfileMicroservice
 
. 

Migrations (
{ 
public 

partial 
class *
nullifyunessentialprofileprops 7
:8 9
	Migration: C
{		 
	protected

 
override

 
void

 
Up

  "
(

" #
MigrationBuilder

# 3
migrationBuilder

4 D
)

D E
{ 	
migrationBuilder 
. 
AlterColumn (
<( )
string) /
>/ 0
(0 1
name 
: 
$str #
,# $
table 
: 
$str !
,! "
type 
: 
$str %
,% &
nullable 
: 
true 
, 

oldClrType 
: 
typeof "
(" #
string# )
)) *
,* +
oldType 
: 
$str (
)( )
;) *
migrationBuilder 
. 
AlterColumn (
<( )
DateTime) 1
>1 2
(2 3
name 
: 
$str  
,  !
table 
: 
$str !
,! "
type 
: 
$str !
,! "
nullable 
: 
true 
, 

oldClrType 
: 
typeof "
(" #
DateTime# +
)+ ,
,, -
oldType 
: 
$str $
)$ %
;% &
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 
AlterColumn (
<( )
string) /
>/ 0
(0 1
name   
:   
$str   #
,  # $
table!! 
:!! 
$str!! !
,!!! "
type"" 
:"" 
$str"" %
,""% &
nullable## 
:## 
false## 
,##  
defaultValue$$ 
:$$ 
$str$$  
,$$  !

oldClrType%% 
:%% 
typeof%% "
(%%" #
string%%# )
)%%) *
,%%* +
oldType&& 
:&& 
$str&& (
,&&( )
oldNullable'' 
:'' 
true'' !
)''! "
;''" #
migrationBuilder)) 
.)) 
AlterColumn)) (
<))( )
DateTime))) 1
>))1 2
())2 3
name** 
:** 
$str**  
,**  !
table++ 
:++ 
$str++ !
,++! "
type,, 
:,, 
$str,, !
,,,! "
nullable-- 
:-- 
false-- 
,--  
defaultValue.. 
:.. 
new.. !
DateTime.." *
(..* +
$num..+ ,
,.., -
$num... /
,../ 0
$num..1 2
,..2 3
$num..4 5
,..5 6
$num..7 8
,..8 9
$num..: ;
,..; <
$num..= >
,..> ?
DateTimeKind..@ L
...L M
Unspecified..M X
)..X Y
,..Y Z

oldClrType// 
:// 
typeof// "
(//" #
DateTime//# +
)//+ ,
,//, -
oldType00 
:00 
$str00 $
,00$ %
oldNullable11 
:11 
true11 !
)11! "
;11" #
}22 	
}33 
}44 ≤!
âC:\Users\Pim\Desktop\Semester 6\Individual project\Code\vybes-backend\ProfileMicroservice\Migrations\20220420143629_nullify-timestamps.cs
	namespace 	
ProfileMicroservice
 
. 

Migrations (
{ 
public 

partial 
class 
nullifytimestamps *
:+ ,
	Migration- 6
{		 
	protected

 
override

 
void

 
Up

  "
(

" #
MigrationBuilder

# 3
migrationBuilder

4 D
)

D E
{ 	
migrationBuilder 
. 
AlterColumn (
<( )
DateTime) 1
>1 2
(2 3
name 
: 
$str !
,! "
table 
: 
$str !
,! "
type 
: 
$str !
,! "
nullable 
: 
true 
, 

oldClrType 
: 
typeof "
(" #
DateTime# +
)+ ,
,, -
oldType 
: 
$str $
)$ %
;% &
migrationBuilder 
. 
AlterColumn (
<( )
DateTime) 1
>1 2
(2 3
name 
: 
$str !
,! "
table 
: 
$str !
,! "
type 
: 
$str !
,! "
nullable 
: 
true 
, 

oldClrType 
: 
typeof "
(" #
DateTime# +
)+ ,
,, -
oldType 
: 
$str $
)$ %
;% &
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 
AlterColumn (
<( )
DateTime) 1
>1 2
(2 3
name   
:   
$str   !
,  ! "
table!! 
:!! 
$str!! !
,!!! "
type"" 
:"" 
$str"" !
,""! "
nullable## 
:## 
false## 
,##  
defaultValue$$ 
:$$ 
new$$ !
DateTime$$" *
($$* +
$num$$+ ,
,$$, -
$num$$. /
,$$/ 0
$num$$1 2
,$$2 3
$num$$4 5
,$$5 6
$num$$7 8
,$$8 9
$num$$: ;
,$$; <
$num$$= >
,$$> ?
DateTimeKind$$@ L
.$$L M
Unspecified$$M X
)$$X Y
,$$Y Z

oldClrType%% 
:%% 
typeof%% "
(%%" #
DateTime%%# +
)%%+ ,
,%%, -
oldType&& 
:&& 
$str&& $
,&&$ %
oldNullable'' 
:'' 
true'' !
)''! "
;''" #
migrationBuilder)) 
.)) 
AlterColumn)) (
<))( )
DateTime))) 1
>))1 2
())2 3
name** 
:** 
$str** !
,**! "
table++ 
:++ 
$str++ !
,++! "
type,, 
:,, 
$str,, !
,,,! "
nullable-- 
:-- 
false-- 
,--  
defaultValue.. 
:.. 
new.. !
DateTime.." *
(..* +
$num..+ ,
,.., -
$num... /
,../ 0
$num..1 2
,..2 3
$num..4 5
,..5 6
$num..7 8
,..8 9
$num..: ;
,..; <
$num..= >
,..> ?
DateTimeKind..@ L
...L M
Unspecified..M X
)..X Y
,..Y Z

oldClrType// 
:// 
typeof// "
(//" #
DateTime//# +
)//+ ,
,//, -
oldType00 
:00 
$str00 $
,00$ %
oldNullable11 
:11 
true11 !
)11! "
;11" #
}22 	
}33 
}44 ∂
kC:\Users\Pim\Desktop\Semester 6\Individual project\Code\vybes-backend\ProfileMicroservice\Models\Profile.cs
	namespace 	
ProfileMicroservice
 
. 
Models $
;$ %
public 
class 
Profile 
{ 
[ 
Key 
] 	
public
 
long 
	ProfileId 
{  !
get" %
;% &
set' *
;* +
}, -
public		 

String		 
UserId		 
{		 
get		 
;		 
set		  #
;		# $
}		% &
public 

String 
UserName 
{ 
get  
;  !
set" %
;% &
}' (
public 

String 
? 
DisplayName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

String 
? 
About 
{ 
get 
; 
set  #
;# $
}% &
public 

String 
? 
PhoneNumber 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

DateTime 
? 
Birthday 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
? 
	CreatedAt 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

DateTime 
? 
	UpdatedAt 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
dC:\Users\Pim\Desktop\Semester 6\Individual project\Code\vybes-backend\ProfileMicroservice\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
ConfigureServices		 
(		 
builder		 
.		 
Services		 "
)		" #
;		# $
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
builder 
. 
Services 
. #
AddEndpointsApiExplorer (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddSwaggerGen 
( 
)  
;  !
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
if 
( 
app 
. 
Environment 
. 
IsDevelopment !
(! "
)" #
)# $
{ 
app 
. 

UseSwagger 
( 
) 
; 
app 
. 
UseSwaggerUI 
( 
) 
; 
} 
app 
. 
UseHttpsRedirection 
( 
) 
; 
app 
. 
UseAuthorization 
( 
) 
; 
app 
. 
MapControllers 
( 
) 
; 
app!! 
.!! 
Run!! 
(!! 
)!! 	
;!!	 

void## 
ConfigureServices## 
(## 
IServiceCollection## )
services##* 2
)##2 3
{$$ 
services%% 
.%% 
AddDbContext%% 
<%% 
AppDbContext%% &
>%%& '
(%%' (
options%%( /
=>%%0 2
{&& 
options'' 
.'' 
UseSqlServer'' 
('' 
builder'' $
.''$ %
Configuration''% 2
[''2 3
$str''3 S
]''S T
,''T U"
sqlServerOptionsAction(( "
:((" #

sqlOptions(($ .
=>((/ 1
{((2 3

sqlOptions((4 >
.((> ? 
EnableRetryOnFailure((? S
(((S T
)((T U
;((U V
}((W X
)((X Y
;((Y Z
})) 
,)) 
ServiceLifetime)) 
.)) 
	Transient))  
)))  !
;))! "
services++ 
.++ 
AddTransient++ 
<++ 
IProfileService++ )
,++) *
ProfileService+++ 9
>++9 :
(++: ;
)++; <
;++< =
services,, 
.,, 
AddTransient,, 
<,, 
IProfileRepository,, ,
,,,, -
ProfileRepository,,. ?
>,,? @
(,,@ A
),,A B
;,,B C
}-- ˛
ÄC:\Users\Pim\Desktop\Semester 6\Individual project\Code\vybes-backend\ProfileMicroservice\Services\Interfaces\IProfileService.cs
	namespace 	
ProfileMicroservice
 
. 
Services &
.& '

Interfaces' 1
;1 2
public 
	interface 
IProfileService  
{ 
List 
< 	
Profile	 
> 
GetProfiles 
( 
) 
;  
Profile		 
?		 
GetProfileById		 
(		 
long		  
	profileId		! *
)		* +
;		+ ,
Profile 
? 
GetProfileByUserId 
(  
string  &
userId' -
)- .
;. /
Profile 
?  
GetProfileByUserName !
(! "
string" (
userName) 1
)1 2
;2 3
Profile 
? 

AddProfile 
( 
Profile 
profile  '
)' (
;( )
Profile 
? 
UpdateProfile 
( 
Profile "
profile# *
)* +
;+ ,
bool 
DeleteProfile	 
( 
Profile 
profile &
)& '
;' (
List 
< 	
Profile	 
> "
FindProfilesByUserName (
(( )
string) /
userName0 8
)8 9
;9 :
List 
< 	
Profile	 
> %
FindProfilesByDisplayName +
(+ ,
string, 2
displayName3 >
)> ?
;? @
} â9
tC:\Users\Pim\Desktop\Semester 6\Individual project\Code\vybes-backend\ProfileMicroservice\Services\ProfileService.cs
	namespace 	
ProfileMicroservice
 
. 
Services &
;& '
public 
class 
ProfileService 
: 
IProfileService -
{		 
private

 
readonly

 
IProfileRepository

 '
_profileRepository

( :
;

: ;
public 

ProfileService 
( 
IProfileRepository ,
profileRepository- >
)> ?
{ 
_profileRepository 
= 
profileRepository .
;. /
} 
public 

List 
< 
Profile 
> 
GetProfiles $
($ %
)% &
{ 
return 
_profileRepository !
.! "
GetProfiles" -
(- .
). /
;/ 0
} 
public 

Profile 
? 
GetProfileById "
(" #
long# '
	profileId( 1
)1 2
{ 
if 

( 
	profileId 
!= 
$num 
) 
{ 	
return 
_profileRepository %
.% &
GetProfileById& 4
(4 5
	profileId5 >
)> ?
;? @
} 	
return 
null 
; 
} 
public   

Profile   
?   
GetProfileByUserId   &
(  & '
string  ' -
userId  . 4
)  4 5
{!! 
if"" 

("" 
userId"" 
!="" 
$str"" 
)"" 
{## 	
return$$ 
_profileRepository$$ %
.$$% &
GetProfileByUserId$$& 8
($$8 9
userId$$9 ?
)$$? @
;$$@ A
}%% 	
return'' 
null'' 
;'' 
}(( 
public** 

Profile** 
?**  
GetProfileByUserName** (
(**( )
string**) /
userName**0 8
)**8 9
{++ 
if,, 

(,, 
userName,, 
!=,, 
$str,, 
),, 
{-- 	
return.. 
_profileRepository.. %
...% & 
GetProfileByUserName..& :
(..: ;
userName..; C
)..C D
;..D E
}// 	
return11 
null11 
;11 
}22 
public44 

Profile44 
?44 

AddProfile44 
(44 
Profile44 &
profile44' .
)44. /
{55 
profile66 
.66 
	CreatedAt66 
=66 
DateTime66 $
.66$ %
Now66% (
;66( )
profile77 
.77 
	UpdatedAt77 
=77 
DateTime77 $
.77$ %
Now77% (
;77( )
bool99 
userIdExists99 
=99 
_profileRepository99 .
.99. /!
ProfileExistsByUserId99/ D
(99D E
profile99E L
.99L M
UserId99M S
)99S T
;99T U
bool:: 
userNameExists:: 
=:: 
_profileRepository:: 0
.::0 1#
ProfileExistsByUserName::1 H
(::H I
profile::I P
.::P Q
UserName::Q Y
)::Y Z
;::Z [
if<< 

(<< 
!<< 
userIdExists<< 
&&<< 
!<< 
userNameExists<< ,
)<<, -
{== 	
return>> 
_profileRepository>> %
.>>% &

AddProfile>>& 0
(>>0 1
profile>>1 8
)>>8 9
;>>9 :
}?? 	
returnAA 
nullAA 
;AA 
}BB 
publicDD 

ProfileDD 
?DD 
UpdateProfileDD !
(DD! "
ProfileDD" )
profileDD* 1
)DD1 2
{EE 
profileFF 
.FF 
	UpdatedAtFF 
=FF 
DateTimeFF $
.FF$ %
NowFF% (
;FF( )
varHH 
existingProfileHH 
=HH 
_profileRepositoryHH 0
.HH0 1
GetProfileByIdHH1 ?
(HH? @
profileHH@ G
.HHG H
	ProfileIdHHH Q
)HHQ R
;HHR S
ifJJ 

(JJ 
existingProfileJJ 
!=JJ 
nullJJ #
)JJ# $
{KK 	
boolLL 
	canCreateLL 
=LL 
trueLL !
;LL! "
ifNN 
(NN 
existingProfileNN 
.NN  
UserNameNN  (
!=NN) +
profileNN, 3
.NN3 4
UserNameNN4 <
)NN< =
{OO 
boolPP 
userNameExistsPP #
=PP$ %
_profileRepositoryPP& 8
.PP8 9#
ProfileExistsByUserNamePP9 P
(PPP Q
profilePPQ X
.PPX Y
UserNamePPY a
)PPa b
;PPb c
ifRR 
(RR 
userNameExistsRR "
)RR" #
{SS 
	canCreateTT 
=TT 
falseTT  %
;TT% &
}UU 
}VV 
ifXX 
(XX 
	canCreateXX 
)XX 
{YY 
returnZZ 
_profileRepositoryZZ )
.ZZ) *
UpdateProfileZZ* 7
(ZZ7 8
profileZZ8 ?
)ZZ? @
;ZZ@ A
}[[ 
}\\ 	
return^^ 
null^^ 
;^^ 
}__ 
publicaa 

boolaa 
DeleteProfileaa 
(aa 
Profileaa %
profileaa& -
)aa- .
{bb 
boolcc 
profileIdExistscc 
=cc 
_profileRepositorycc 1
.cc1 2$
ProfileExistsByProfileIdcc2 J
(ccJ K
profileccK R
.ccR S
	ProfileIdccS \
)cc\ ]
;cc] ^
ifee 

(ee 
profileIdExistsee 
)ee 
{ff 	
returngg 
_profileRepositorygg %
.gg% &
DeleteProfilegg& 3
(gg3 4
profilegg4 ;
)gg; <
;gg< =
}hh 	
returnjj 
falsejj 
;jj 
}kk 
publicmm 

Listmm 
<mm 
Profilemm 
>mm "
FindProfilesByUserNamemm /
(mm/ 0
stringmm0 6
userNamemm7 ?
)mm? @
{nn 
returnoo 
_profileRepositoryoo !
.oo! ""
FindProfilesByUserNameoo" 8
(oo8 9
userNameoo9 A
)ooA B
;ooB C
}pp 
publicrr 

Listrr 
<rr 
Profilerr 
>rr %
FindProfilesByDisplayNamerr 2
(rr2 3
stringrr3 9
displayNamerr: E
)rrE F
{ss 
returntt 
_profileRepositorytt !
.tt! "%
FindProfilesByDisplayNamett" ;
(tt; <
displayNamett< G
)ttG H
;ttH I
}uu 
}vv 